<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>百度商业服务市场-轮换图1</title>
<style type="text/css">
body{background: #272822; text-align: center;}
body, ul{ margin:0; padding:0;}
li{list-style:none;}
a{color:#0a8cd2;text-decoration:none;cursor: pointer;}
a:hover{text-decoration:underline;}
h2{font-size: 30px; text-align: center;}
.clearfix:after{content:".";display:block;height:0;clear:both;visibility:hidden;}
.clearfix{display:inline-block;}
.clearfix{display:block;}
.clear{clear:both;height:0;font:0/0 Arial;visibility:hidden;}
.none{display:none}
/* main.css */
.wrapper{text-align:center;width:980px;position:relative;}
.index-banner{width:980px;height:208px;position:relative;overflow: hidden;}
.index-banner ul{z-index:2;position: absolute;top: 0;left: 0;}
.index-banner ul li{height: 210px; margin: 0; padding: 0;}
.index-banner ul li{vertical-align: middle; zoom: 1;}
.index-banner ul li{display: block; width: 980px; height: 210px;}
.index-banner ul li img{display: block; width: 980px; height: 210px;}
.banner-ico-box{position:absolute;left:0;bottom:20px;width:100%;text-align:center; z-index:4;}
.banner-ico-box a{width:10px;height:10px;display:inline-block;background:url(img/banner-btn.png) -16px -50px no-repeat;margin-right:8px}
.banner-ico-box .active{width:10px;height:10px;display:inline-block;background:url(img/banner-btn.png) -1px -50px no-repeat}
.prev,.next{ z-index:3;width:50px;height:50px;display:inline-block;position:absolute;top:50%;margin-top:-25px;}
.prev{background:url(img/banner-btn.png) 0 0 no-repeat;left:0;}
.next{background:url(img/banner-btn.png) -50px 0 no-repeat;right:0;}
</style>
</head>
<body>
<div class="wrapper">
    <div id="index-banner" class="index-banner">
        <ul class="list clearfix">
            <li>
                <a target="_blank"><img src="img/1.jpg"></a>
            </li>
            <li>
                <a target="_blank"><img src="img/2.png"></a>
            </li>
            <li>
                <a target="_blank"><img src="img/3.jpg"></a>
            </li>
            <li>
                <a target="_blank"><img src="img/4.png"></a>
            </li>
            <li>
                <a target="_blank"><img src="img/5.jpg"></a>
            </li>
        </ul>
        <div class="banner-ico-box">
            <a class="active"></a>
            <a class=""></a>
            <a class=""></a>
            <a class=""></a>
            <a class=""></a>
        </div>
        <div>
            <a class="prev"></a>
            <a class="next"></a>
        </div>
    </div>
</div>


<select id="select">
    <option value="left">left</option>
    <option value=:"leftLoop">leftLoop</option>
    <option value="leftLoop">top</option>
    <option value="leftLoop">topLoop</option>
</select>

<script type="text/javascript">
function Slider(id, options) {
    options = options || {};
    this.init(id, options);
}
Slider.prototype = {
    init: function (id, options) {
        var _this = this;
        this.oDiv = document.getElementById(id);
        this.oUl = this.oDiv.getElementsByTagName('ul')[0];
        this.aLi = this.oUl.getElementsByTagName('li');
        this.aImg = this.oUl.getElementsByTagName('img');
        this.oIcon = this.oDiv.getElementsByTagName('div')[0];
        this.aBtn = this.oIcon.getElementsByTagName('a');
        this.oBtn = this.oDiv.getElementsByTagName('div')[1];
        this.oPrev = this.oBtn.getElementsByTagName('a')[0];
        this.oNext = this.oBtn.getElementsByTagName('a')[1];
        this.now = 0;
        this.timer = null;
        this.isMoveing = false;
        this.effect = options.effect || 'left';
        this.trigger = options.trigger || 'click';
        // 初始化li宽度
        for (var i = 0; i < this.aLi.length; i++) {
            if (this.effect === 'left' || this.effect === 'leftLoop') {
                this.aLi[i].style.cssFloat = 'left';  
                this.aLi[i].style.styleFloat = 'left'; 
            }
            this.aLi[i].style.width = this.aImg[0].offsetWidth + 'px';
            
        }
        // 初始化ul宽度和起始位置
        if (this.effect === 'leftLoop' || this.effect === 'topLoop') {
            
            if (this.effect === 'leftLoop') {
                this.oUl.style.left = -this.aLi[0].offsetWidth + 'px';
            } else {
                this.oUl.style.top = -this.aLi[0].offsetHeight + 'px';
            }
            this.oUl.appendChild(this.aLi[0].cloneNode(true));
            this.oUl.insertBefore(this.aLi[this.aLi.length - 2].cloneNode(true), this.aLi[0]);
        }
        if (this.effect === 'left' || this.effect === 'leftLoop') {
            this.oUl.style.width = this.aLi[0].offsetWidth*this.aLi.length + 'px';
        }
        
        // 按钮绑定点击事件
        this.addEvent(this.oPrev, "click", function () {_this.doPrev.call(_this)});
        this.addEvent(this.oNext, "click", function () {_this.doNext.call(_this)});
        for (var i = 0; i < this.aBtn.length; i++) {
            this.aBtn[i].index = i;
            this.aBtn[i]['on' + this.trigger] = function () {
                if (this.index === _this.now) {
                    return false;
                }
                _this.now = this.index;
                _this.doSwicth.call(_this);
            }    
        }
        // 自动播放
        // this.timer = setInterval(function () {_this.doNext.call(_this)}, 1000);
        // this.addEvent(this.oDiv, "mouseover", function () {clearInterval(_this.timer)});
        // this.addEvent(this.oDiv, "mouseout", function () {
        //     _this.timer = setInterval(function () {_this.doNext.call(_this)}, 1000);
        // });
    },
    doPrev: function () {
        if (!this.isMoveing) {
            this.now--
            this.doSwicth();
        }
    },
    doNext: function () {
        if (!this.isMoveing) {
            this.now++;
            this.doSwicth();
        }
    },
    // 按钮切换、大图切换
    doSwicth: function () {
        var _this = this;
        this.isMoveing = true;
        switch(this.effect) {
            case 'left':        this.doMoveNormal('left');  break; 
            case 'leftLoop':    this.doMoveLoop('left');    break; 
            case 'top':         this.doMoveNormal('top');   break; 
            case 'topLoop':     this.doMoveLoop('top');     break;
            case 'fade':        this.doFade();              break;  
            default:            this.doLeft();              break; 
        }
        for (var i = 0; i < this.aBtn.length; i++) {
            this.aBtn[i].className = '';
        }
        this.aBtn[this.now].className = 'active';
    },
    doMoveNormal: function (moveStyle) {
        var attr = moveStyle; 
        var offset = moveStyle === 'left' ? 'offsetWidth' : 'offsetHeight';
        var oOptions = {};
        if (this.now === this.aLi.length) {
            this.now = 0;
        } else if (this.now === -1) {
            this.now = this.aLi.length-1;
        }
        oOptions[attr] = -this.aLi[0][offset]*(this.aBtn[this.now].index);
        this.doMove(this.oUl, oOptions, function () {
            this.isMoveing = false; 
        }); 
    },
    doMoveLoop: function (moveStyle) {
        var attr = moveStyle; 
        var offset = moveStyle === 'left' ? 'offsetWidth' : 'offsetHeight';
        var oOptions = {};
        
        if (this.now === (this.aLi.length - 2)) {
            oOptions[attr] = -this.aLi[0][offset]*(this.aLi.length - 1);
            this.doMove(this.oUl, oOptions, function () {
                this.oUl.style[attr] = -this.aLi[0][offset] + 'px';
                this.isMoveing = false; 
            });
            this.now = 0;
        } else if (this.now === -1) {
            oOptions[attr] = 0;
            this.doMove(this.oUl, oOptions, function () {
                this.oUl.style[attr] = -this.aLi[0][offset]*(this.aLi.length - 2) + 'px'; 
                this.isMoveing = false; 

            });
            this.now = this.aLi.length - 3;
        } else {
            oOptions[attr] = -this.aLi[0][offset]*(this.aBtn[this.now].index + 1);
            this.doMove(this.oUl, oOptions, function () {
                this.isMoveing = false; 
            });  
        }
    },
    doFade: function () {
        if (this.now === this.aLi.length) {
            this.now = 0;
        } else if (this.now === -1) {
            this.now = this.aLi.length-1;
        }
        for (var i = 0; i < this.aLi.length; i++) {
            this.css(this.aLi[i], 'display', 'none');
            this.css(this.aLi[i], 'opacity', 0);
        }
        this.css(this.aLi[this.now], 'display', 'block');
        this.doMove(this.aLi[this.now], {'opacity': 100});
        this.isMoveing = false; 
    },
    addEvent: function (oElement, sEventType, fnHandle) {
        oElement.addEventListener ? oElement.addEventListener(sEventType, fnHandle, false) : oElement.attachEvent('on' + sEventType, fnHandle);
    },
    css: function (oElement, attr, value) {
        if (arguments.length === 2) {
            return oElement.currentStyle ? oElement.currentStyle[attr] : getComputedStyle(oElement, false)[attr];
        } else if (arguments.length === 3) {
            switch(attr) {
                case 'width':
                case 'height':
                case 'top':
                case 'left':
                case 'bottom':
                    oElement.style[attr] = value + 'px';
                    break;
                case 'opacity':
                    oElement.style.filter = 'alpha(opacity:' + value + ')';
                    oElement.style.opacity = value / 100;
                    break;
                default:
                    oElement.style[attr] = value;
                    break;
            }
        }
    },
    doMove: function (oElement, oAttr, fnCallback) {
        var _this = this;
        clearInterval(oElement.timer);
        oElement.timer = setInterval(function () {
            var bStop = true;
            for (var property in oAttr) {
                var iCur = parseFloat(_this.css(oElement, property));
                property === 'opacity' && (iCur = parseInt(iCur.toFixed(2) * 100));
                var iSpeed = (oAttr[property] - iCur) / 6;
                iSpeed = iSpeed > 0 ? Math.ceil(iSpeed) : Math.floor(iSpeed);

                if (iCur != oAttr[property]) {
                    bStop = false;
                    _this.css(oElement, property, iCur + iSpeed);
                } 
            }
            if (bStop) {
                clearInterval(oElement.timer);
                fnCallback && fnCallback.call(_this);   
            }
        }, 30);
    }
}
window.onload = function () {
    var oSelect = document.getElementById('select');

    oSelect.onchange = function () {
        new Slider('index-banner', {effect: this.value, trigger: 'click'});
    }

    new Slider('index-banner', {effect: 'left', trigger: 'click'});
}
</script>
</body>
</html>